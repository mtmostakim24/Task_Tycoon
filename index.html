<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Task Tycoon Vercel App | Premium Earning Platform</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', system-ui, sans-serif;
    }

    body {
      background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
      color: #fff;
      min-height: 100vh;
      padding-bottom: 70px;
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #4CAF50;
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      z-index: 1000;
      transform: translateX(150%);
      transition: transform 0.3s ease;
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification.error {
      background: #f44336;
    }

    .notification.warning {
      background: #ff9800;
    }

    .notification i {
      margin-right: 10px;
      font-size: 20px;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .title {
      display: flex;
      align-items: center;
      font-size: 18px;
      font-weight: bold;
    }

    .title i {
      margin-right: 10px;
      font-size: 24px;
      color: #fdbb2d;
    }

    .balance-display {
      display: flex;
      align-items: center;
      background: rgba(255, 255, 255, 0.1);
      padding: 8px 15px;
      border-radius: 20px;
      font-weight: bold;
    }

    .balance-display i {
      margin-right: 8px;
      color: #4CAF50;
    }

    .profile-container {
      padding: 20px;
    }

    .profile {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }

    .profile-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .profile-img-container {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      overflow: hidden;
      margin-right: 15px;
      border: 3px solid #fdbb2d;
    }

    .profile-img-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .profile-info {
      flex: 1;
    }

    .name {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .user-id {
      font-size: 14px;
      opacity: 0.8;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-top: 20px;
    }

    .stat-item {
      background: rgba(0, 0, 0, 0.2);
      padding: 15px;
      border-radius: 12px;
      text-align: center;
    }

    .stat-value {
      font-size: 20px;
      font-weight: bold;
      color: #fdbb2d;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 12px;
      opacity: 0.8;
    }

    .cards-container {
      padding: 0 20px 20px;
    }

    .card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }

    .card-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding-bottom: 15px;
    }

    .card-header i {
      font-size: 24px;
      margin-right: 10px;
      color: #fdbb2d;
    }

    .card-header h3 {
      font-size: 18px;
      font-weight: bold;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .info-label {
      font-size: 14px;
      opacity: 0.8;
    }

    .info-value {
      font-size: 14px;
      font-weight: bold;
    }

    .progress-container {
      background: rgba(0, 0, 0, 0.2);
      height: 10px;
      border-radius: 5px;
      overflow: hidden;
      margin: 15px 0;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(to right, #4CAF50, #8BC34A);
      border-radius: 5px;
      width: 0%;
      transition: width 0.5s ease;
    }

    .progress-info {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      margin-bottom: 15px;
    }

    .task-visual {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 5px;
      margin: 15px 0;
    }

    .task-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
    }

    .task-dot.completed {
      background: #4CAF50;
    }

    .btn {
      background: linear-gradient(135deg, #4CAF50, #2E7D32);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      display: block;
      width: 100%;
      text-align: center;
      transition: all 0.3s ease;
      margin-top: 15px;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #2196F3, #0D47A1);
    }

    .btn-telegram {
      background: linear-gradient(135deg, #0088cc, #005580);
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .form-group select, .form-group input {
      width: 100%;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(0, 0, 0, 0.2);
      color: white;
    }

    .referral-section {
      text-align: center;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .referral-link {
      background: rgba(0, 0, 0, 0.2);
      padding: 12px;
      border-radius: 8px;
      margin: 15px 0;
      font-size: 12px;
      word-break: break-all;
    }

    .btn-group {
      display: flex;
      gap: 10px;
    }

    .btn-group .btn {
      flex: 1;
    }

    .nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      display: flex;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      padding: 10px 0;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .nav-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 5px 0;
      cursor: pointer;
      opacity: 0.6;
      transition: all 0.3s ease;
    }

    .nav-item.active {
      opacity: 1;
    }

    .nav-icon {
      font-size: 20px;
      margin-bottom: 5px;
    }

    .nav-label {
      font-size: 12px;
    }

    .profile-card {
      padding: 20px;
    }

    .profile-section {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }

    .profile-section-title {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding-bottom: 15px;
    }

    .profile-section-title i {
      font-size: 24px;
      margin-right: 10px;
      color: #fdbb2d;
    }

    .profile-section-title h3 {
      font-size: 18px;
      font-weight: bold;
    }

    .profile-info-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .profile-info-label {
      font-size: 14px;
      opacity: 0.8;
    }

    .profile-info-value {
      font-size: 14px;
      font-weight: bold;
    }

    .loading {
      text-align: center;
      padding: 20px;
      font-size: 16px;
    }

    .loading i {
      margin-right: 10px;
    }

    /* Referral History Styles */
    .referral-history {
      margin-top: 20px;
    }

    .history-header {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      padding: 10px 15px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      font-weight: bold;
      font-size: 12px;
      margin-bottom: 10px;
    }

    .history-item {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      padding: 12px 15px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      margin-bottom: 8px;
      align-items: center;
    }

    .history-id {
      font-weight: bold;
      font-size: 12px;
    }

    .history-earned {
      font-size: 12px;
    }

    .history-progress {
      font-size: 12px;
      display: flex;
      align-items: center;
    }

    .progress-circle {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: conic-gradient(#4CAF50 0%, #2c3e50 0%);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 8px;
      position: relative;
    }

    .progress-circle-inner {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: #1a2a6c;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 8px;
      font-weight: bold;
    }

    .history-status {
      font-size: 10px;
      padding: 4px 8px;
      border-radius: 20px;
      text-align: center;
      font-weight: bold;
    }

    .status-pending {
      background: #ff9800;
      color: #000;
    }

    .status-active {
      background: #4CAF50;
      color: white;
    }

    .empty-history {
      text-align: center;
      padding: 20px;
      font-size: 14px;
      opacity: 0.7;
    }

    /* Login Form Styles */
    .login-container {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
    }

    .login-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 25px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }

    .login-header {
      text-align: center;
      margin-bottom: 25px;
    }

    .login-header i {
      font-size: 40px;
      color: #fdbb2d;
      margin-bottom: 15px;
    }

    .login-header h2 {
      font-size: 24px;
      margin-bottom: 10px;
    }

    .login-header p {
      opacity: 0.8;
      font-size: 14px;
    }

    .form-control {
      margin-bottom: 15px;
    }

    .form-control label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .form-control input {
      width: 100%;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(0, 0, 0, 0.2);
      color: white;
    }

    .form-control input:focus {
      outline: none;
      border-color: #fdbb2d;
    }

    .register-link {
      text-align: center;
      margin-top: 20px;
      font-size: 14px;
    }

    .register-link a {
      color: #fdbb2d;
      text-decoration: none;
    }

    /* Hero Section */
    .hero-section {
      text-align: center;
      padding: 30px 20px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      margin-bottom: 25px;
    }

    .hero-section h1 {
      font-size: 28px;
      margin-bottom: 15px;
      color: #fdbb2d;
    }

    .hero-section p {
      font-size: 16px;
      opacity: 0.9;
      margin-bottom: 20px;
    }

    .features {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin: 20px 0;
    }

    .feature-item {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 10px;
      text-align: center;
    }

    .feature-item i {
      font-size: 24px;
      color: #4CAF50;
      margin-bottom: 10px;
    }

    .feature-item p {
      font-size: 12px;
      opacity: 0.9;
    }

    /* Video Section */
    .video-section {
      margin-top: 25px;
      text-align: center;
    }

    .video-section h3 {
      margin-bottom: 15px;
      font-size: 18px;
      color: #fdbb2d;
    }

    .video-placeholder {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 40px 20px;
      margin-bottom: 15px;
    }

    .video-placeholder i {
      font-size: 50px;
      color: #fdbb2d;
      margin-bottom: 15px;
    }

    .video-placeholder p {
      font-size: 14px;
      opacity: 0.8;
    }

    /* Telegram Proof Section */
    .telegram-proof {
      text-align: center;
      margin-top: 25px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .telegram-proof h3 {
      margin-bottom: 15px;
      font-size: 18px;
    }

    .telegram-proof p {
      font-size: 14px;
      opacity: 0.8;
      margin-bottom: 15px;
    }
  </style>
</head>
<body>
  <div class="notification" id="notification">
    <i class="fas fa-check-circle"></i>
    <span id="notification-message">Notification message</span>
  </div>

  <!-- Login Section -->
  <div id="login-section" class="login-container">
    <div class="login-card">
      <div class="hero-section">
        <h1>Task Tycoon Vercel App</h1>
        <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ü‡¶ú‡¶á! ‡¶∏‡¶π‡¶ú ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡ßá ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p>
        
        <div class="features">
          <div class="feature-item">
            <i class="fas fa-money-bill-wave"></i>
            <p>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® $1.5 ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶Ü‡¶Ø‡¶º</p>
          </div>
          <div class="feature-item">
            <i class="fas fa-user-friends"></i>
            <p>‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶Ü‡¶Ø‡¶º</p>
          </div>
          <div class="feature-item">
            <i class="fas fa-gift"></i>
            <p>‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°</p>
          </div>
          <div class="feature-item">
            <i class="fas fa-shield-alt"></i>
            <p>‡ßß‡ß¶‡ß¶% ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü</p>
          </div>
        </div>
      </div>
      
      <div class="login-header">
        <i class="fas fa-robot"></i>
        <h2>‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
        <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶™‡¶æ‡¶®</p>
      </div>
      
      <form id="login-form">
        <div class="form-control">
          <label for="mobile">‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</label>
          <input type="tel" id="mobile" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®" required>
        </div>
        
        <div class="form-control">
          <label for="password">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°</label>
          <input type="password" id="password" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®" required>
        </div>
        
        <button type="submit" class="btn">
          <i class="fas fa-sign-in-alt"></i> ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
        
        <div class="register-link">
          ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á? <a href="#" id="show-register">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</a>
        </div>
      </form>

      <div class="video-section">
        <h3>‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?</h3>
        <div class="video-placeholder">
          <i class="fas fa-play-circle"></i>
          <p>‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ü‡¶æ‡¶á‡¶ï‡ßÅ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ó‡¶æ‡¶á‡¶°</p>
          <p>‡¶≠‡¶ø‡¶°‡¶ø‡¶ì‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡ßá ‡¶∂‡¶ø‡¶ñ‡ßÅ‡¶® ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶Ü‡¶Ø‡¶º ‡¶ï‡¶∞‡¶¨‡ßá‡¶®</p>
        </div>
        <button class="btn btn-secondary">
          <i class="fas fa-play"></i> ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
        </button>
      </div>

      <div class="telegram-proof">
        <h3>‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡ßÅ‡¶´</h3>
        <p>‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶∏‡¶´‡¶≤ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡ßÅ‡¶´</p>
        <button class="btn btn-telegram">
          <i class="fab fa-telegram"></i> ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ú‡¶Ø‡¶º‡ßá‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
      </div>
    </div>
  </div>

  <!-- Registration Section -->
  <div id="registration-section" class="login-container" style="display:none;">
    <div class="login-card">
      <div class="login-header">
        <i class="fas fa-user-plus"></i>
        <h2>‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
        <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</p>
      </div>
      
      <form id="registration-form">
        <div class="form-control">
          <label for="name">‡¶™‡ßÅ‡¶∞‡ßã ‡¶®‡¶æ‡¶Æ</label>
          <input type="text" id="name" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßÅ‡¶∞‡ßã ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶®" required>
        </div>
        
        <div class="form-control">
          <label for="mobile">‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</label>
          <input type="tel" id="reg-mobile" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®" required>
        </div>
        
        <div class="form-control">
          <label for="password">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°</label>
          <input type="password" id="reg-password" placeholder="‡¶è‡¶ï‡¶ü‡¶ø ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®" required>
        </div>
        
        <div class="form-control">
          <label for="confirm-password">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</label>
          <input type="password" id="confirm-password" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®" required>
        </div>
        
        <div class="form-control">
          <label for="referral-code">‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶ï‡ßã‡¶° (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)</label>
          <input type="text" id="referral-code" placeholder="‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶ï‡ßã‡¶° ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶¶‡¶ø‡¶®">
        </div>
        
        <button type="submit" class="btn">
          <i class="fas fa-user-plus"></i> ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
        
        <div class="register-link">
          ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá? <a href="#" id="show-login">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</a>
        </div>
      </form>
    </div>
  </div>

  <!-- Main App Content (Initially Hidden) -->
  <div id="main-app" style="display:none;">
    <header>
      <div class="title">
        <i class="fas fa-robot"></i>
        <span>Task Tycoon Vercel App</span>
      </div>
      <div class="balance-display">
        <i class="fas fa-wallet"></i>
        <span id="header-balance">$0.000</span>
      </div>
    </header>

    <div id="loading" class="loading">
      <i class="fas fa-spinner fa-spin"></i> Loading user data...
    </div>

    <div class="profile-container" id="home-profile" style="display:none;">
      <div class="profile">
        <div class="profile-header">
          <div class="profile-img-container">
            <img id="profile-pic" src="https://i.ibb.co.com/TDJWNCwh/A-New-Design-1762931077372.jpg" alt="Profile">
          </div>
          <div class="profile-info">
            <div class="name" id="username">Loading...</div>
            <div class="user-id">ID: <span id="user-id">Loading...</span></div>
          </div>
        </div>
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value" id="total-earned">$0.000</div>
            <div class="stat-label">Total Earned</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="tasks-completed">0</div>
            <div class="stat-label">Task Done</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="lifetime-earning">$0.000</div>
            <div class="stat-label">Lifetime Earning</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="referral-earnings">$0</div>
            <div class="stat-label">Referral Earning</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Home Page Content -->
    <div class="cards-container" id="home-content" style="display:none;">
      <div class="card">
        <div class="card-header">
          <i class="fas fa-tasks"></i>
          <h3>Today's Tasks</h3>
        </div>
        <div class="card-content">
          <div class="info-row">
            <span class="info-label">Total Tasks</span>
            <span class="info-value" id="total">100</span>
          </div>
          <div class="info-row">
            <span class="info-label">Completed</span>
            <span class="info-value" id="completed-card">0</span>
          </div>
          <div class="info-row">
            <span class="info-label">Remaining</span>
            <span class="info-value" id="remaining-card">100</span>
          </div>
          <div class="progress-container">
            <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
          </div>
          <div class="progress-info">
            <span>Progress</span>
            <span id="progress-percent">0%</span>
          </div>
          <div class="task-visual" id="task-visual">
            <!-- Task dots will be generated here -->
          </div>
          <button class="btn" onclick="startTask()">
            <i class="fas fa-play"></i> Start Task
          </button>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <i class="fas fa-coins"></i>
          <h3>Earnings Summary</h3>
        </div>
        <div class="card-content">
          <div class="info-row">
            <span class="info-label">Today's Earning</span>
            <span class="info-value">$<span id="todays-earning">0.000</span></span>
          </div>
          <div class="info-row">
            <span class="info-label">Lifetime Earning</span>
            <span class="info-value">$<span id="lifetime-earning-card">0.000</span></span>
          </div>
          <div class="info-row">
            <span class="info-label">Current Balance</span>
            <span class="info-value">$<span id="current-balance">0.000</span></span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <i class="fas fa-user-friends"></i>
          <h3>Referral Program</h3>
        </div>
        <div class="card-content">
          <div class="info-row">
            <span class="info-label">Total Referrals</span>
            <span class="info-value" id="referral-count">0</span>
          </div>
          <div class="info-row">
            <span class="info-label">Referral Earnings</span>
            <span class="info-value">$<span id="ref-earned">0.000</span></span>
          </div>
          <div class="referral-section">
            <p>Invite friends and earn $1 for each successful referral!</p>
            <div class="referral-link" id="ref-link">Loading referral link...</div>
            <div class="btn-group">
              <button class="btn btn-secondary" onclick="copyReferralLink()">
                <i class="fas fa-copy"></i> Copy Link
              </button>
              <button class="btn" onclick="shareReferralLink()">
                <i class="fas fa-share-alt"></i> Share
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Page -->
    <div class="profile-card" id="profile-page" style="display:none;">
      <div class="profile-section">
        <div class="profile-section-title">
          <i class="fas fa-user-circle"></i>
          <h3>Account Information</h3>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Username</span>
          <span class="profile-info-value" id="profile-username">Loading...</span>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">User ID</span>
          <span class="profile-info-value" id="profile-user-id">Loading...</span>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Join Date</span>
          <span class="profile-info-value" id="join-date">Loading...</span>
        </div>
      </div>

      <div class="profile-section">
        <div class="profile-section-title">
          <i class="fas fa-chart-line"></i>
          <h3>Earnings Statistics</h3>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Current Balance</span>
          <span class="profile-info-value">$<span id="profile-balance">0.000</span></span>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Total Withdrew</span>
          <span class="profile-info-value">$<span id="profile-withdrew">0.000</span></span>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Today's Earning</span>
          <span class="profile-info-value">$<span id="profile-today-earning">0.000</span></span>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Lifetime Earning</span>
          <span class="profile-info-value">$<span id="profile-lifetime-earning">0.000</span></span>
        </div>
      </div>

      <div class="profile-section">
        <div class="profile-section-title">
          <i class="fas fa-users"></i>
          <h3>Referral Information</h3>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Total Referrals</span>
          <span class="profile-info-value" id="profile-refer-count">0</span>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Pending Referrals</span>
          <span class="profile-info-value" id="profile-pending-refs">0</span>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Referral Earnings</span>
          <span class="profile-info-value">$<span id="profile-refer-earnings">0.000</span></span>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Your Referral Link</span>
          <span class="profile-info-value" style="font-size: 12px;" id="profile-ref-link">Loading...</span>
        </div>
        <div class="btn-group" style="margin-top: 15px;">
          <button class="btn btn-secondary" onclick="copyReferralLink()">
            <i class="fas fa-copy"></i> Copy Link
          </button>
          <button class="btn" onclick="shareReferralLink()">
            <i class="fas fa-share-alt"></i> Share
          </button>
        </div>
      </div>

      <div class="profile-section">
        <div class="profile-section-title">
          <i class="fas fa-tasks"></i>
          <h3>Task Statistics</h3>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Tasks Completed</span>
          <span class="profile-info-value" id="profile-tasks-completed">0</span>
        </div>
        <div class="profile-info-item">
          <span class="profile-info-label">Tasks Today</span>
          <span class="profile-info-value" id="profile-tasks-today">0/100</span>
        </div>
      </div>

      <!-- Referral History Section -->
      <div class="profile-section">
        <div class="profile-section-title">
          <i class="fas fa-history"></i>
          <h3>Referral History</h3>
        </div>
        <div class="referral-history">
          <div class="history-header">
            <div>ID</div>
            <div>Earned</div>
            <div>%</div>
            <div>Status</div>
          </div>
          <div id="referral-history-list">
            <!-- Referral history items will be generated here -->
          </div>
        </div>
      </div>
    </div>

    <div class="nav">
      <div class="nav-item active" id="nav-home" onclick="show('home')">
        <div class="nav-icon">
          <i class="fas fa-home"></i>
        </div>
        <div class="nav-label">Home</div>
      </div>
      <div class="nav-item" id="nav-earn" onclick="show('earn')">
        <div class="nav-icon">
          <i class="fas fa-coins"></i>
        </div>
        <div class="nav-label">Earn</div>
      </div>
      <div class="nav-item" id="nav-withdraw" onclick="show('withdraw')">
        <div class="nav-icon">
          <i class="fas fa-wallet"></i>
        </div>
        <div class="nav-label">Withdraw</div>
      </div>
      <div class="nav-item" id="nav-profile" onclick="show('profile')">
        <div class="nav-icon">
          <i class="fas fa-user"></i>
        </div>
        <div class="nav-label">Profile</div>
      </div>
    </div>
  </div>

  <script>
    // Global variables
    let userData = null;
    let data = null;
    let currentUser = null;

    // Generate referral codes
    function generateReferralCode() {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let result = '';
      // First 2 characters are numbers
      for (let i = 0; i < 2; i++) {
        result += Math.floor(Math.random() * 10);
      }
      // Next 6 characters are mixed
      for (let i = 0; i < 6; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return result;
    }

    // Check if mobile number already exists
    function isMobileRegistered(mobile) {
      const users = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
      return users.hasOwnProperty(mobile);
    }

    // Get user IP address (simulated)
    function getUserIP() {
      return "192.168." + Math.floor(Math.random() * 255) + "." + Math.floor(Math.random() * 255);
    }

    // Check if IP address already has an account
    function isIPRegistered(ip) {
      const ipUsers = JSON.parse(localStorage.getItem('ipUsers') || '{}');
      return ipUsers.hasOwnProperty(ip);
    }

    // Register new user
    function registerUser(userData) {
      const users = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
      users[userData.mobile] = userData;
      localStorage.setItem('registeredUsers', JSON.stringify(users));
      
      // Store IP address to prevent multiple accounts
      const ipUsers = JSON.parse(localStorage.getItem('ipUsers') || '{}');
      ipUsers[userData.ip] = userData.mobile;
      localStorage.setItem('ipUsers', JSON.stringify(ipUsers));
      
      // Set current user
      localStorage.setItem('currentUser', JSON.stringify(userData));
      currentUser = userData;
      
      // Initialize user data
      initializeUserData(userData);
    }

    // Initialize user data after registration
    function initializeUserData(user) {
      const userId = user.id;
      const today = new Date().toLocaleDateString();
      
      // Initialize new user data
      userData = {
        userId, 
        username: user.name,
        firstName: user.name,
        mobile: user.mobile,
        referrals: 0,
        referralEarnings: 0,
        pendingReferrals: 0,
        lifetimeEarning: 0.50, // Registration bonus $0.50
        withdrew: 0,
        totalTasks: 0,
        joinDate: today,
        referralHistory: [],
        referredBy: user.referredBy || null,
        referralCode: user.referralCode
      };
      
      data = {
        date: today, 
        completed: 0, 
        remaining: 100, 
        todaysEarning: 0
      };
      
      // Save to localStorage
      localStorage.setItem(`MTEarningData_${userId}`, JSON.stringify(userData));
      localStorage.setItem(`dailyEarningData_${userId}`, JSON.stringify(data));
      
      // Show welcome message and bonus notification
      showNotification("üéâ Welcome to Task Tycoon Vercel App! You received $0.50 registration bonus.", "success");
      
      // Hide registration and show main app
      document.getElementById('registration-section').style.display = 'none';
      document.getElementById('main-app').style.display = 'block';
      document.getElementById('loading').style.display = 'none';
      document.getElementById('home-profile').style.display = 'block';
      document.getElementById('home-content').style.display = 'block';
      
      // Update display
      updateDisplay();
      
      // Check for referral and update referrer's data
      if (user.referredBy) {
        updateReferrerData(user.referredBy, userId);
      }
    }

    // ‚úÖ FIXED: Update referrer's data - COMPLETELY REWRITTEN
    function updateReferrerData(referrerCode, referredUserId) {
      console.log("üîÑ Updating referrer data for code:", referrerCode, "Referred user:", referredUserId);
      
      // Find referrer by code
      const users = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
      let referrer = null;
      
      for (const mobile in users) {
        if (users[mobile].referralCode === referrerCode) {
          referrer = users[mobile];
          break;
        }
      }
      
      if (referrer) {
        console.log("‚úÖ Found referrer:", referrer.name);
        
        // Get referrer's data
        const referrerDataKey = `MTEarningData_${referrer.id}`;
        const storedReferrerData = localStorage.getItem(referrerDataKey);
        
        if (storedReferrerData) {
          const referrerData = JSON.parse(storedReferrerData);
          
          // Initialize referralHistory if it doesn't exist
          if (!referrerData.referralHistory) {
            referrerData.referralHistory = [];
          }
          
          // Check if referral already exists to avoid duplicates
          const existingReferral = referrerData.referralHistory.find(ref => ref.id === referredUserId);
          if (!existingReferral) {
            // Add new referral
            const newReferral = {
              id: referredUserId,
              earned: 0,
              progress: 0,
              status: 'pending'
            };
            
            referrerData.referralHistory.push(newReferral);
            referrerData.pendingReferrals = (referrerData.pendingReferrals || 0) + 1;
            
            // Save updated referrer data
            localStorage.setItem(referrerDataKey, JSON.stringify(referrerData));
            
            console.log("‚úÖ Referral added successfully!");
            showNotification("üéâ Referral added! You'll earn $1 when they complete $15 in tasks.", "success");
            
            // Update display if referrer is current user
            if (currentUser && referrerData.userId === currentUser.id) {
              updateDisplay();
            }
          } else {
            console.log("‚ÑπÔ∏è Referral already exists");
          }
        } else {
          console.log("‚ùå Referrer data not found");
        }
      } else {
        console.log("‚ùå Referrer not found with code:", referrerCode);
        showNotification("Invalid referral code", "warning");
      }
    }

    // ‚úÖ FIXED: Update referral progress when referred user earns
    function updateReferralProgress(referredUserId, amountEarned) {
      console.log("üîÑ Updating referral progress for:", referredUserId, "Amount:", amountEarned);
      
      const users = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
      
      for (const mobile in users) {
        const user = users[mobile];
        const userDataKey = `MTEarningData_${user.id}`;
        const storedUserData = localStorage.getItem(userDataKey);
        
        if (storedUserData) {
          const userData = JSON.parse(storedUserData);
          
          if (userData.referralHistory && userData.referralHistory.length > 0) {
            const referralIndex = userData.referralHistory.findIndex(ref => ref.id == referredUserId);
            
            if (referralIndex !== -1) {
              console.log("‚úÖ Found referral in user's history:", userData.userId);
              
              // Update the referral progress
              userData.referralHistory[referralIndex].earned += amountEarned;
              userData.referralHistory[referralIndex].progress = Math.min(100, (userData.referralHistory[referralIndex].earned / 15) * 100);
              
              // Check if referral is now active
              if (userData.referralHistory[referralIndex].earned >= 15 && userData.referralHistory[referralIndex].status === 'pending') {
                userData.referralHistory[referralIndex].status = 'active';
                userData.pendingReferrals = Math.max(0, (userData.pendingReferrals || 0) - 1);
                userData.referrals = (userData.referrals || 0) + 1;
                userData.referralEarnings = (userData.referralEarnings || 0) + 1.00;
                userData.lifetimeEarning = (userData.lifetimeEarning || 0) + 1.00;
                
                console.log("üéâ Referral activated! Bonus added.");
                showNotification("üí∞ Referral bonus! $1.00 added to your balance.", "success");
              }
              
              // Save updated user data
              localStorage.setItem(userDataKey, JSON.stringify(userData));
              
              // Update display if this is the current user
              if (currentUser && userData.userId === currentUser.id) {
                updateDisplay();
              }
            }
          }
        }
      }
    }

    // Initialize the app when page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Check if user is already registered
      const storedCurrentUser = localStorage.getItem('currentUser');
      
      if (storedCurrentUser) {
        // User is already registered, show main app
        currentUser = JSON.parse(storedCurrentUser);
        loadUserData(currentUser);
      } else {
        // User is not registered, show login form
        document.getElementById('login-section').style.display = 'block';
        document.getElementById('main-app').style.display = 'none';
        
        // Handle login form submission
        document.getElementById('login-form').addEventListener('submit', function(e) {
          e.preventDefault();
          
          const mobile = document.getElementById('mobile').value;
          const password = document.getElementById('password').value;
          
          // Validate login
          const users = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
          if (users[mobile] && users[mobile].password === password) {
            // Login successful
            localStorage.setItem('currentUser', JSON.stringify(users[mobile]));
            currentUser = users[mobile];
            loadUserData(currentUser);
            showNotification("Login successful!", "success");
          } else {
            showNotification("Invalid mobile number or password", "error");
          }
        });
        
        // Handle registration form submission
        document.getElementById('registration-form').addEventListener('submit', function(e) {
          e.preventDefault();
          
          const name = document.getElementById('name').value;
          const mobile = document.getElementById('reg-mobile').value;
          const password = document.getElementById('reg-password').value;
          const confirmPassword = document.getElementById('confirm-password').value;
          const referralCode = document.getElementById('referral-code').value;
          
          // Validate form
          if (password !== confirmPassword) {
            showNotification("Passwords do not match", "error");
            return;
          }
          
          if (isMobileRegistered(mobile)) {
            showNotification("This mobile number is already registered", "error");
            return;
          }
          
          // Check IP address
          const userIP = getUserIP();
          if (isIPRegistered(userIP)) {
            showNotification("Only one account per device is allowed", "error");
            return;
          }
          
          // Generate user ID and referral code
          const userId = Math.floor(100000 + Math.random() * 900000);
          const userReferralCode = generateReferralCode();
          
          // Create user object
          const newUser = {
            id: userId,
            name: name,
            mobile: mobile,
            password: password,
            referralCode: userReferralCode,
            referredBy: referralCode || null,
            ip: userIP
          };
          
          // Register user
          registerUser(newUser);
        });
        
        // Toggle between login and registration
        document.getElementById('show-register').addEventListener('click', function(e) {
          e.preventDefault();
          document.getElementById('login-section').style.display = 'none';
          document.getElementById('registration-section').style.display = 'block';
        });
        
        document.getElementById('show-login').addEventListener('click', function(e) {
          e.preventDefault();
          document.getElementById('registration-section').style.display = 'none';
          document.getElementById('login-section').style.display = 'block';
        });
        
        // Check URL for referral code
        const urlParams = new URLSearchParams(window.location.search);
        const refCode = urlParams.get('ref');
        if (refCode) {
          document.getElementById('referral-code').value = refCode;
          showNotification("Referral code detected from URL!", "success");
        }
        
        // Telegram channel button
        document.querySelector('.btn-telegram').addEventListener('click', function() {
          window.open('https://t.me/your_channel_link', '_blank');
        });
        
        // Video tutorial button
        document.querySelector('.btn-secondary').addEventListener('click', function() {
          showNotification("Video tutorial will be available soon!", "success");
        });
      }
    });

    // Load user data for registered users
    function loadUserData(user) {
      const userId = user.id;
      const today = new Date().toLocaleDateString();
      
      // Try to load existing user data
      const storedUserData = localStorage.getItem(`MTEarningData_${userId}`);
      const storedDailyData = localStorage.getItem(`dailyEarningData_${userId}`);
      
      if (storedUserData && storedDailyData) {
        userData = JSON.parse(storedUserData);
        data = JSON.parse(storedDailyData);
        
        // Check if data is for today
        if (data.date !== today) {
          // Reset daily data for new day
          data = {
            date: today, 
            completed: 0, 
            remaining: 100, 
            todaysEarning: 0
          };
        }
      } else {
        // Initialize user data if not exists (for backward compatibility)
        initializeUserData(user);
        return;
      }
      
      // Hide loading and show content
      document.getElementById('login-section').style.display = 'none';
      document.getElementById('registration-section').style.display = 'none';
      document.getElementById('main-app').style.display = 'block';
      document.getElementById('loading').style.display = 'none';
      document.getElementById('home-profile').style.display = 'block';
      document.getElementById('home-content').style.display = 'block';
      
      // Update display
      updateDisplay();
    }

    function updateStorage() {
      if (userData && userData.userId) {
        localStorage.setItem(`MTEarningData_${userData.userId}`, JSON.stringify(userData));
        localStorage.setItem(`dailyEarningData_${userData.userId}`, JSON.stringify(data));
      }
    }

    function updateDisplay() {
      if (!userData || !data) return;
      
      // Update home screen
      document.getElementById("username").innerText = userData.firstName || userData.username;
      document.getElementById("user-id").innerText = userData.userId;
      document.getElementById("completed-card").innerText = data.completed;
      document.getElementById("remaining-card").innerText = data.remaining;
      document.getElementById("todays-earning").innerText = data.todaysEarning.toFixed(3);
      document.getElementById("lifetime-earning-card").innerText = userData.lifetimeEarning.toFixed(3);
      document.getElementById("current-balance").innerText = (userData.lifetimeEarning - userData.withdrew).toFixed(3);
      document.getElementById("header-balance").innerText = "$" + (userData.lifetimeEarning - userData.withdrew).toFixed(3);
      
      // Update stats grid
      document.getElementById("total-earned").innerText = "$" + (userData.lifetimeEarning - userData.withdrew).toFixed(3);
      document.getElementById("tasks-completed").innerText = userData.totalTasks;
      document.getElementById("lifetime-earning").innerText = "$" + userData.lifetimeEarning.toFixed(3);
      document.getElementById("referral-earnings").innerText = "$" + (userData.referralEarnings || 0).toFixed(3);
      
      // Update progress bar
      const progressPercent = (data.completed / 100 * 100);
      document.getElementById("progress-bar").style.width = progressPercent + "%";
      document.getElementById("progress-percent").innerText = progressPercent.toFixed(0) + "%";
      
      // Update profile stats
      document.getElementById("profile-balance").innerText = (userData.lifetimeEarning - userData.withdrew).toFixed(3);
      document.getElementById("profile-withdrew").innerText = userData.withdrew.toFixed(3);
      document.getElementById("profile-tasks-completed").innerText = userData.totalTasks;
      
      // Update referral section
      document.getElementById("ref-earned").innerText = (userData.referralEarnings || 0).toFixed(3);
      document.getElementById("referral-count").innerText = userData.referrals || 0;
      document.getElementById("ref-link").innerText = `https://task-tycoon.vercel.app/?ref=${userData.referralCode}`;
      
      // Update profile page
      document.getElementById("profile-username").innerText = userData.firstName || userData.username;
      document.getElementById("profile-user-id").innerText = userData.userId;
      document.getElementById("profile-refer-count").innerText = userData.referrals || 0;
      document.getElementById("profile-refer-earnings").innerText = (userData.referralEarnings || 0).toFixed(3);
      document.getElementById("profile-today-earning").innerText = data.todaysEarning.toFixed(3);
      document.getElementById("profile-lifetime-earning").innerText = userData.lifetimeEarning.toFixed(3);
      document.getElementById("join-date").innerText = userData.joinDate;
      document.getElementById("profile-pending-refs").innerText = userData.pendingReferrals || 0;
      document.getElementById("profile-ref-link").innerText = `https://task-tycoon.vercel.app/?ref=${userData.referralCode}`;
      document.getElementById("profile-tasks-today").innerText = `${data.completed}/100`;
      
      // Update referral history
      updateReferralHistoryDisplay();
      
      // Update task visualization
      updateTaskVisualization();
    }

    // Update referral history display
    function updateReferralHistoryDisplay() {
      const historyList = document.getElementById("referral-history-list");
      
      if (!userData.referralHistory || userData.referralHistory.length === 0) {
        historyList.innerHTML = '<div class="empty-history">No referral history yet</div>';
        return;
      }
      
      historyList.innerHTML = '';
      
      userData.referralHistory.forEach(referral => {
        const historyItem = document.createElement("div");
        historyItem.className = "history-item";
        
        const progressPercentage = Math.min(100, (referral.earned / 15) * 100);
        const progressColor = referral.status === 'active' ? '#4CAF50' : '#ff9800';
        
        historyItem.innerHTML = `
          <div class="history-id">${referral.id}</div>
          <div class="history-earned">$${referral.earned.toFixed(2)}</div>
          <div class="history-progress">
            <div class="progress-circle" style="background: conic-gradient(${progressColor} ${progressPercentage}%, #2c3e50 ${progressPercentage}%)">
              <div class="progress-circle-inner">${Math.round(progressPercentage)}%</div>
            </div>
          </div>
          <div class="history-status ${referral.status === 'active' ? 'status-active' : 'status-pending'}">${referral.status}</div>
        `;
        
        historyList.appendChild(historyItem);
      });
    }

    function updateTaskVisualization() {
      const homeVisual = document.getElementById("task-visual");
      homeVisual.innerHTML = "";
      
      // Create 100 dots (10 rows of 10)
      for (let i = 0; i < 10; i++) {
        const row = document.createElement("div");
        row.style.display = "flex";
        row.style.justifyContent = "center";
        row.style.gap = "5px";
        row.style.marginBottom = "5px";
        
        for (let j = 0; j < 10; j++) {
          const dot = document.createElement("div");
          dot.className = "task-dot";
          const index = i * 10 + j;
          
          if (index < data.completed) {
            dot.classList.add("completed");
          }
          
          row.appendChild(dot);
        }
        
        homeVisual.appendChild(row);
      }
    }

    const taskLinks = [
      "https://tomake-chai-vlona.vercel.app",
      "https://premium-sm-offer.vercel.app",
    ];

    function showNotification(message, type) {
      const notification = document.getElementById("notification");
      const messageElement = document.getElementById("notification-message");
      
      messageElement.textContent = message;
      notification.className = "notification " + (type || "success");
      notification.classList.add("show");
      
      setTimeout(() => {
        notification.classList.remove("show");
      }, 3000);
    }

    function startTask() {
      if (data.completed >= 100) {
        showNotification("You have completed all tasks for today!", "warning");
        return;
      }
      
      const start = Date.now();
      const ad = window.open(taskLinks[data.completed % taskLinks.length], "_blank");
      
      if (!ad) {
        showNotification("Please allow popups to complete tasks", "error");
        return;
      }
      
      const check = setInterval(() => {
        if (ad.closed) {
          clearInterval(check);
          const duration = (Date.now() - start) / 1000;
          
          if (duration >= 17) {
            data.completed++;
            data.remaining = 100 - data.completed;
            data.todaysEarning += 0.015;
            userData.lifetimeEarning += 0.015;
            userData.totalTasks++;
            
            // ‚úÖ FIXED: Update referral progress for this user
            updateReferralProgress(userData.userId, 0.015);
            
            updateStorage();
            updateDisplay();
            showNotification("‚úÖ Task completed! $0.015 added to your balance.", "success");
            
            // Check if all tasks completed for bonus
            if (data.completed === 100) {
              userData.lifetimeEarning += 0.10;
              updateStorage();
              updateDisplay();
              showNotification("üéâ Congratulations! You completed all tasks and earned a $0.10 bonus!", "success");
            }
          } else {
            showNotification("‚è±Ô∏è You must view the ad for at least 15 seconds to complete the task!", "error");
          }
        }
      }, 500);
    }

    function show(section) {
      // Hide all sections first
      document.getElementById("home-profile").style.display = "none";
      document.getElementById("home-content").style.display = "none";
      document.getElementById("profile-page").style.display = "none";
      
      // Show appropriate section
      if (section === 'home') {
        document.getElementById("home-profile").style.display = "block";
        document.getElementById("home-content").style.display = "block";
      } else if (section === 'profile') {
        document.getElementById("profile-page").style.display = "block";
      }
      
      // Update navigation
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      document.getElementById("nav-" + section).classList.add('active');
    }

    function copyReferralLink() {
      if (!userData) return;
      
      const refLink = `https://task-tycoon.vercel.app/?ref=${userData.referralCode}`;
      navigator.clipboard.writeText(refLink)
        .then(() => showNotification("‚úÖ Referral link copied! You earn $1 for each successful referral.", "success"))
        .catch(() => showNotification("Failed to copy link", "error"));
    }
    
    function shareReferralLink() {
      if (!userData) return;
      
      const refLink = `https://task-tycoon.vercel.app/?ref=${userData.referralCode}`;
      
      if (navigator.share) {
        navigator.share({
          title: 'Earn with Task Tycoon Vercel App',
          text: 'Join Task Tycoon Vercel App and start earning money by completing simple tasks!',
          url: refLink
        })
        .catch((error) => {
          console.error('Sharing failed:', error);
          copyReferralLink();
        });
      } else {
        copyReferralLink();
      }
    }

    // Initialize task visualization
    updateTaskVisualization();
  </script>
</body>
</html>
